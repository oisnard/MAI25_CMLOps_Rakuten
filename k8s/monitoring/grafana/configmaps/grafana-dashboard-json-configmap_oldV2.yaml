apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboard-json
  namespace: monitoring
data:
  rakuten_dashboard.json: "{\n  \"id\": null,\n  \"uid\": \"rakuten-api-dashboard\"\
    ,\n  \"title\": \"Rakuten API Dashboard\",\n  \"tags\": [\n    \"api\",\n    \"\
    rakuten-api\",\n    \"prometheus\"\n  ],\n  \"timezone\": \"browser\",\n  \"schemaVersion\"\
    : 38,\n  \"version\": 2,\n  \"refresh\": \"5s\",\n  \"panels\": [\n    {\n   \
    \   \"type\": \"graph\",\n      \"title\": \"Total HTTP Requests\",\n      \"\
    targets\": [\n        {\n          \"expr\": \"sum by (method, status) (http_requests_total{job=\\\
    \"rakuten-api\\\"})\",\n          \"legendFormat\": \"{{method}} {{status}}\",\n \
    \         \"refId\": \"A\"\n        }\n      ],\n      \"gridPos\": {\n      \
    \  \"h\": 8,\n        \"w\": 8,\n        \"x\": 0,\n        \"y\": 0\n      }\n\
    \    },\n    {\n      \"type\": \"graph\",\n      \"title\": \"Request Duration\
    \ (seconds)\",\n      \"targets\": [\n        {\n          \"expr\": \"rate(http_request_duration_seconds_bucket{job=\\\
    \"rakuten-api\\\"}[1m])\",\n          \"legendFormat\": \"{{le}}\",\n          \"\
    refId\": \"A\"\n        }\n      ],\n      \"gridPos\": {\n        \"h\": 8,\n\
    \        \"w\": 8,\n        \"x\": 8,\n        \"y\": 0\n      }\n    },\n   \
    \ {\n      \"type\": \"graph\",\n      \"title\": \"CPU Time (seconds)\",\n  \
    \    \"targets\": [\n        {\n          \"expr\": \"rate(process_cpu_seconds_total{job=\\\
    \"rakuten-api\\\"}[1m])\",\n          \"legendFormat\": \"CPU\",\n          \"refId\"\
    : \"A\"\n        }\n      ],\n      \"gridPos\": {\n        \"h\": 8,\n      \
    \  \"w\": 8,\n        \"x\": 0,\n        \"y\": 8\n      }\n    },\n    {\n  \
    \    \"type\": \"stat\",\n      \"title\": \"Memory Usage (Resident)\",\n    \
    \  \"targets\": [\n        {\n          \"expr\": \"process_resident_memory_bytes{job=\\\
    \"rakuten-api\\\"}\",\n          \"legendFormat\": \"Memory\",\n          \"refId\"\
    : \"A\"\n        }\n      ],\n      \"gridPos\": {\n        \"h\": 8,\n      \
    \  \"w\": 4,\n        \"x\": 8,\n        \"y\": 8\n      }\n    },\n    {\n  \
    \    \"type\": \"graph\",\n      \"title\": \"GC Collections\",\n      \"targets\"\
    : [\n        {\n          \"expr\": \"rate(python_gc_collections_total{job=\\\"\
    rakuten-api\\\"}[1m])\",\n          \"legendFormat\": \"Gen {{generation}}\",\n  \
    \        \"refId\": \"A\"\n        }\n      ],\n      \"gridPos\": {\n       \
    \ \"h\": 8,\n        \"w\": 4,\n        \"x\": 12,\n        \"y\": 8\n      }\n\
    \    },\n    {\n      \"type\": \"graph\",\n      \"title\": \"HTTP Requests per\
    \ Second\",\n      \"targets\": [\n        {\n          \"expr\": \"rate(http_requests_total{job=\\\
    \"rakuten-api\\\"}[1m])\",\n          \"legendFormat\": \"{{method}} {{status}}\"\
    ,\n          \"refId\": \"A\"\n        }\n      ],\n      \"gridPos\": {\n   \
    \     \"h\": 8,\n        \"w\": 8,\n        \"x\": 0,\n        \"y\": 16\n   \
    \   }\n    }\n  ],\n  \"templating\": {\n    \"list\": []\n  },\n  \"annotations\"\
    : {\n    \"list\": []\n  },\n  \"time\": {\n    \"from\": \"now-15m\",\n    \"\
    to\": \"now\"\n  }\n}"
